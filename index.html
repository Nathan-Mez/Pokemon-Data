<!DOCTYPE html>
<html lang = "en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Pokemon</title>
    <meta name="description" content="Details on different Pokemons, including names and heights">
    <meta name="keywords" content="Pokemon, Pokedex">
    <link href="img/favicon.svg" rel="shortcut icon">
    <link href="https://fonts.googleapis.com/css2?family=Jost:wght@300&family=Poppins:wght@200;300;400;500&family=Raleway:wght@200;300;400;500&display=swap" rel="stylesheet">

    <!--................ CSS Files .........................-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  </head>
<!--_____________________End of Head section__________________________________-->

  <body>
    <div>
      <!--Navbar-->
      <nav class="navbar">
         <a class="navbar-brand"><h1>Pokemon</h1></a>
        <form class="form-inline">
            <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
            <button class="btn btn-secondary btn-sm" type="submit">Search</button>
        </form>
      </nav>

      <ul class='list-group'></ul>

      <!-- Modal container-->
      <div class="container">

          <!-- Modal -->
        <div class="modal fade" id="myModal" role="dialog">
          <div class="modal-dialog modal-dialog-centered">

           <!-- Modal content-->
             <div class="modal-content">
               <div class="modal-header">
                  <h4 class="modal-title"></h4>
                  <button type="button" class="btn btn-outline-danger dismiss" data-dismiss="modal"><span aria-hidden="true">&times;</span></button></button>
              </div>
              <div class="modal-body">
                <img class="modal-image-front" alt="Front image of Pokemon">
                <img class="modal-image-back" alt="Back image of Pokemon">
                 <p class = "modal-height"></p>
                 <p class = "modal-weight"></p>
                 <p class = "modal-order"></p>
                 <p class = "modal-id"></p>
              </div>
           </div>

         </div>
      </div>
    </div>

    <!--.................JS Files.......................-->
    <script src="js/promise-polyfill.js"></script>
    <script src="js/fetch-polyfill.js"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

    <script>
      let pokemonList = [];
      let apiUrl = 'https://pokeapi.co/api/v2/pokemon/?limit=54';

      function addListItem(pokemon){
        let pokemonList = document.querySelector('.list-group');

        let listItem = document.createElement('li');
        listItem.classList.add('list-group-item');

        let button = document.createElement('button');
        button.innerText = pokemon.name;
        button.classList.add('btn', 'btn-info', 'col-sm-3', 'col-md-2', 'col-lg-1.5');
        button.setAttribute('data-toggle', 'modal');
        button.setAttribute('data-target', '#myModal');

        listItem.appendChild(button);
        pokemonList.appendChild(listItem);
        button.addEventListener('click', function(event){
          loadDetails(pokemon).then(function () {
            console.log(pokemon);
            document.querySelector('.modal-title').innerText = pokemon.name;
            document.querySelector('.modal-image-front').setAttribute('src', pokemon.imgUrl_1);
            document.querySelector('.modal-image-back').setAttribute('src', pokemon.imgUrl_2);
            document.querySelector('.modal-height').innerText = 'Height:   '+pokemon.height;
            document.querySelector('.modal-weight').innerText = 'Weight:   '+pokemon.weight;
            document.querySelector('.modal-id').innerText = 'ID:   '+pokemon.id;
            document.querySelector('.modal-order').innerText = 'Order:   '+pokemon.order;
          });
        });
      }

      function loadList() {
        return fetch(apiUrl).then(function (response) {
           return response.json();
        }).then(function (json) {
          json.results.forEach(function (item) {
            let pokemon = {
              name: item.name,
              detailsUrl: item.url
            };
            pokemonList.push(pokemon);
          });
        }).catch(function (e) {
          console.error(e);
        })
      }

      function loadDetails(item) {
        let url = item.detailsUrl;
        return fetch(url).then(function (response) {
          return response.json();
        }).then(function (details) {
          item.imgUrl_1 = details.sprites.front_default;
          item.imgUrl_2 = details.sprites.back_default;
          item.weight = details.weight;
          item.id = details.id;
          item.height = details.height;
          item.order = details.order;

        }).catch(function (e) {
          console.error(e);
        });
      }

    //List of pokemon button
    loadList().then(function() {
      pokemonList.forEach(function(pokemon){
        addListItem(pokemon);
      });
   });
  </script>

  </body>
</html>
